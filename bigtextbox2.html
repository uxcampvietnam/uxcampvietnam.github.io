<!DOCTYPE html>
<html lang="vi">

<head>
	<meta charset="UTF-8" />
	<title>Mini Notes</title>
	<style>
		* {
			box-sizing: border-box;
		}

		body {
			margin: 0;
			font-family: system-ui, -apple-system, BlinkMacSystemFont, sans-serif;
			background: #f2f2f2;
		}

		.app {
			display: flex;
			height: 100vh;
		}

		/* Sidebar */
		.sidebar {
			width: 260px;
			background: #fafafa;
			border-right: 1px solid #ddd;
			padding: 12px;
			display: flex;
			flex-direction: column;
		}

		.new-note {
			padding: 10px;
			margin-bottom: 12px;
			cursor: pointer;
		}

		#noteList {
			list-style: none;
			padding: 0;
			margin: 0;
			overflow-y: auto;
		}

		#noteList li {
			padding: 10px;
			border-radius: 6px;
			cursor: pointer;
		}

		#noteList li.active {
			background: #e0e0e0;
		}

		/* Editor */
		.editor-wrapper {
			flex: 1;
			display: flex;
			flex-direction: column;
		}

		.toolbar {
			padding: 10px;
			background: white;
			border-bottom: 1px solid #ddd;
			display: flex;
			gap: 6px;
			flex-wrap: wrap;
		}

		.toolbar button {
			padding: 6px 10px;
			cursor: pointer;
		}

		.divider {
			width: 1px;
			background: #ccc;
			margin: 0 6px;
		}

		.editor {
			flex: 1;
			padding: 24px;
			background: white;
			overflow-y: auto;
			outline: none;
		}

		.editor h1 {
			font-size: 32px;
		}

		.editor h2 {
			font-size: 28px;
		}

		.editor h3 {
			font-size: 24px;
		}

		.editor h4 {
			font-size: 20px;
		}

		.editor h5 {
			font-size: 18px;
		}

		.editor h6 {
			font-size: 16px;
		}

		.editor p {
			font-size: 16px;
			line-height: 1.6;
		}

		.editor img {
			max-width: 100%;
			display: block;
			margin: 12px 0;
			border-radius: 6px;
		}
	</style>

</head>

<body>

	<div class="app">
		<!-- Sidebar -->
		<aside class="sidebar">
			<button class="new-note" onclick="createNote()">＋ New Note</button>
			<ul id="noteList"></ul>
		</aside>

		<!-- Editor -->
		<main class="editor-wrapper">
			<div class="toolbar">
				<button onclick="setBlock('h1')">H1</button>
				<button onclick="setBlock('h2')">H2</button>
				<button onclick="setBlock('h3')">H3</button>
				<button onclick="setBlock('h4')">H4</button>
				<button onclick="setBlock('h5')">H5</button>
				<button onclick="setBlock('h6')">H6</button>
				<button onclick="setBlock('p')">Body</button>

				<span class="divider"></span>

				<button onclick="cmd('bold')">B</button>
				<button onclick="cmd('italic')">I</button>
				<button onclick="cmd('underline')">U</button>

				<span class="divider"></span>

				<button onclick="cmd('justifyLeft')">⟸</button>
				<button onclick="cmd('justifyCenter')">≡</button>
				<button onclick="cmd('justifyRight')">⟹</button>
			</div>

			<div id="editor" class="editor" contenteditable="true"></div>
		</main>
	</div>

	<script>
		let notes = JSON.parse(localStorage.getItem("notes") || "[]");
		let currentId = null;

		const editor = document.getElementById("editor");
		const noteList = document.getElementById("noteList");

		function save() {
			localStorage.setItem("notes", JSON.stringify(notes));
		}

		function renderList() {
			noteList.innerHTML = "";
			notes.forEach(note => {
				const li = document.createElement("li");
				li.textContent = note.title || "Untitled";
				li.className = note.id === currentId ? "active" : "";
				li.onclick = () => loadNote(note.id);
				noteList.appendChild(li);
			});
		}

		function createNote() {
			const note = {
				id: Date.now(),
				title: "New Note",
				content: ""
			};
			notes.unshift(note);
			loadNote(note.id);
			save();
			renderList();
		}

		function loadNote(id) {
			const note = notes.find(n => n.id === id);
			if (!note) return;
			currentId = id;
			editor.innerHTML = note.content;
			renderList();
		}

		editor.addEventListener("input", () => {
			const note = notes.find(n => n.id === currentId);
			if (!note) return;
			note.content = editor.innerHTML;
			note.title = editor.innerText.split("\n")[0].slice(0, 30);
			save();
			renderList();
		});

		/* Commands */
		function cmd(command) {
			document.execCommand(command);
		}

		function setBlock(tag) {
			document.execCommand("formatBlock", false, tag);
		}

		/* Paste image */
		editor.addEventListener("paste", e => {
			const items = e.clipboardData.items;
			for (const item of items) {
				if (item.type.startsWith("image")) {
					e.preventDefault();
					const file = item.getAsFile();
					const reader = new FileReader();
					reader.onload = ev => {
						const img = document.createElement("img");
						img.src = ev.target.result;
						editor.appendChild(img);
					};
					reader.readAsDataURL(file);
				}
			}
		});

		/* Keyboard shortcuts */
		document.addEventListener("keydown", e => {
			if (!e.metaKey) return;

			if (e.key >= "1" && e.key <= "6") {
				e.preventDefault();
				setBlock("h" + e.key);
			}

			if (e.key === "0") {
				e.preventDefault();
				setBlock("p");
			}
		});

	</script>
</body>

</html>